package chopLifter;

import java.awt.Graphics;
import java.awt.Image;

public class EnemyPlane extends GameObj {
	private double dx, dy; // 단위 이동 거리
	private int tmpW;
	private int uTurn;
	private int turnPount = 140;
	private boolean noTurn = false;
	EnemyPlane(Image img, int w, int h) {
		image = img;
		state = ST_DEATH; // 처음 만들 때 Death상태로 생성함.
		tmpW = w;
		width = tmpW;
		height = h;
	}

	void birth() { // 이동방향, 이동속도, 출발높이, 전환지점을 지정함.
		state = ST_ALIVE;
		x = -40;
		dx = 0;
		dy = 0;
		y = Util.rand(40, ChopLifter.FRAME_H / 5 * 3);
		uTurn = 0;
		noTurn = false;
	}

	// 폭발 상태 설정
	void blast() {
		state = ST_BLAST;
		blast_count = 15;
	}

	void fall() {
		if (state == ST_ALIVE) {
			dy = 10;
			noTurn = true;
		}
	}

	void move() {
		// ALIVE 상태에서는 좌우로 이동
		if (state == ST_ALIVE) {
			if (x > ChopLifter.FRAME_W - 140) {
				uTurn = 1;
			} else if (x < 140 && uTurn != 2) {
				uTurn = 2;
			}
			if (y >= ChopLifter.FRAME_H / 5 * 4) {
				blast();
			}

			if (uTurn == 0) {
				if(noTurn == false)
					width = tmpW;
				if (dx < 10) {
					dx += 0.5;
				}
			} else if (uTurn == 1) {
				if(noTurn == false)
					width = -tmpW;
				if (dx > -10) {
					dx -= 0.5;
				}
			} else if (uTurn == 2) {
				if(noTurn == false)
					width = tmpW;
				if (dx < 10) {
					dx += 0.5;
				}
			}

			x += dx;
			y += dy;
		}
		// BLAST 상태에서는 count 시간 후 DEATH로 설정
		else if (state == ST_BLAST) {
			blast_count--;
			if (blast_count == 0) {
				state = ST_DEATH;
			}
		}
	}

	void draw(Graphics g) {
		if (state == ST_ALIVE) {
			drawImage(g);
		} else if (state == ST_BLAST) {
			drawBlast(g);
		}
	}
}